%p
  %img{src: soalition.icon, style: 'height:92px;'}

%h2
  &= soalition.name

%p
  &= soalition.description

%p
  Your score:
  %strong= soalition.score(author.login)

%p
  Invite your friends:
  %a{href: "/join?id=#{soalition.id}"}= "https://www.soalition.com/join?id=#{soalition.id}"

%form{method: 'POST', action: '/do-share'}
  %fieldset
    %input{type: 'hidden', name: 'id', id: 'id', value: soalition.id}
    %label URL of the blog post:
    %input{type: 'url', name: 'uri', id: 'uri', autofocus: 'true', size: 50, required: 'true', autocomplete: 'off'}
    %label.small.gray
      Make sure the content you share is publicly accessible
      by everyone in this soalition and is relevant to its main topic.
      The most popular content is: blog posts, Tweets, Facebook posts,
      and YouTube videos.
    %input{type: 'submit', value: 'Share'}

%p
  Members:
  - soalition.members.each_with_index do |m, i|
    - if i > 0
      = ', '
    %a{href: "https://twitter.com/#{m}"}= "@#{m}"

- soalition.posts.each do |p|
  %p{class: p.approved? ? '' : 'gray'}
    By
    %a{href: "https://twitter.com/#{p.author}"}= "@#{p.author}"
    %a{href: p.uri}= p.uri
    - if !p.approved?
      = "(not approved yet)"
  - reposts = p.reposts.fetch
  - if !reposts.empty?
    %ul
      - reposts.each do |r|
        %li{style: (r['approved'] == 't' ? '' : 'gray')}
          = succeed ':' do
            %a{href: "https://twitter.com/#{r['author']}"}= "@#{r['author']}"
          %a{href: r['uri']}= "@#{r['uri']}"
          - if r['approved'] == 'f'
            = "(pending)"
